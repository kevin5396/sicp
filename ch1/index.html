<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>index</title>
<!-- 2016-09-25 Sun 10:32 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="kevin5396" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="/css/book/style.css" /><link rel="stylesheet" type="text/css" href="/css/code.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">index</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Exercise 1.1</a></li>
<li><a href="#sec-2">2. Exercise 1.2</a></li>
<li><a href="#sec-3">3. Exercise 1.3</a></li>
<li><a href="#sec-4">4. Exercise 1.4</a></li>
<li><a href="#sec-5">5. Exercise 1.5</a></li>
<li><a href="#sec-6">6. Exercise 1.6</a></li>
<li><a href="#sec-7">7. Exercise 1.7</a></li>
<li><a href="#sec-8">8. Exercise 1.8</a></li>
<li><a href="#sec-9">9. Exercise 1.9</a></li>
<li><a href="#sec-10">10. Exercise 1.10</a></li>
<li><a href="#sec-11">11. Exercise 1.11</a></li>
<li><a href="#sec-12">12. Exercise 1.12</a></li>
<li><a href="#sec-13">13. Exercise 1.13</a></li>
<li><a href="#sec-14">14. Exercise 1.14</a></li>
<li><a href="#sec-15">15. Exercise 1.15</a>
<ul>
<li><a href="#sec-15-1">15.1. a</a></li>
<li><a href="#sec-15-2">15.2. b</a></li>
</ul>
</li>
<li><a href="#sec-16">16. Exercise 1.16</a></li>
<li><a href="#sec-17">17. Exercise 1.17</a></li>
<li><a href="#sec-18">18. Exercise 1.18</a></li>
<li><a href="#sec-19">19. Exercise 1.19</a></li>
<li><a href="#sec-20">20. Exercise 1.20</a></li>
<li><a href="#sec-21">21. Exercise 1.21</a></li>
<li><a href="#sec-22">22. Exercise 1.22</a></li>
<li><a href="#sec-23">23. Exercise 1.23</a></li>
<li><a href="#sec-24">24. Exercise 1.24</a></li>
<li><a href="#sec-25">25. Exercise 1.25</a></li>
<li><a href="#sec-26">26. Exercise 1.26</a></li>
<li><a href="#sec-27">27. Exercise 1.27</a></li>
<li><a href="#sec-28">28. Exercise 1.28</a></li>
<li><a href="#sec-29">29. Exercise 1.29</a></li>
<li><a href="#sec-30">30. Exercise 1.30</a></li>
<li><a href="#sec-31">31. Exercise 1.31</a></li>
<li><a href="#sec-32">32. Exercise 1.32</a></li>
<li><a href="#sec-33">33. Exercise 1.33</a></li>
<li><a href="#sec-34">34. Exercise 1.34</a></li>
<li><a href="#sec-35">35. Exercise 1.35</a></li>
<li><a href="#sec-36">36. Exercise 1.36</a></li>
<li><a href="#sec-37">37. Exercise 1.37</a></li>
<li><a href="#sec-38">38. Exercise 1.38</a></li>
<li><a href="#sec-39">39. Exercise 1.39</a></li>
<li><a href="#sec-40">40. Exercise 1.40</a></li>
<li><a href="#sec-41">41. Exercise 1.41</a></li>
<li><a href="#sec-42">42. Exercise 1.42</a></li>
<li><a href="#sec-43">43. Exercise 1.43</a></li>
<li><a href="#sec-44">44. Exercise 1.44</a></li>
<li><a href="#sec-45">45. Exercise 1.45</a></li>
<li><a href="#sec-46">46. Exercise 1.46</a></li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Exercise 1.1</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">

<pre class="src src-scheme">10
<span class="org-rainbow-delimiters-depth-1">(</span>+ 5 3 4<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>- 9 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>/ 6 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 2 4<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>- 4 6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">a</span> 3<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">b</span> <span class="org-rainbow-delimiters-depth-2">(</span>+ a 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ a b <span class="org-rainbow-delimiters-depth-2">(</span>* a b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>= a b<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; b a<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; b <span class="org-rainbow-delimiters-depth-4">(</span>* a b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
        b
        a<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>= a 4<span class="org-rainbow-delimiters-depth-3">)</span> 6<span class="org-rainbow-delimiters-depth-2">)</span>
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>= b 4<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>+ 6 7 a<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">else</span> 25<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 2 <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; b a<span class="org-rainbow-delimiters-depth-3">)</span> b a<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>* <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
                 <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&lt; a b<span class="org-rainbow-delimiters-depth-4">)</span> b<span class="org-rainbow-delimiters-depth-3">)</span>
                 <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> -1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
   <span class="org-rainbow-delimiters-depth-2">(</span>+ a 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Exercise 1.2</h2>
<div class="outline-text-2" id="text-2">
<p>
I've rewritten it in valid scheme-format.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>/ <span class="org-rainbow-delimiters-depth-2">(</span>+ 5 4 <span class="org-rainbow-delimiters-depth-3">(</span>- 2 <span class="org-rainbow-delimiters-depth-4">(</span>- 3 <span class="org-rainbow-delimiters-depth-5">(</span>+ 6 <span class="org-rainbow-delimiters-depth-6">(</span>/ 4 5<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
   <span class="org-rainbow-delimiters-depth-2">(</span>* 3 <span class="org-rainbow-delimiters-depth-3">(</span>- 6 2<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>- 2 7<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Exercise 1.3</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">; </span><span class="org-comment">A simple implementation</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum-sqr-big-0</span> a b c<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span>
                          <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>&gt; b c<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>+ <span class="org-rainbow-delimiters-depth-7">(</span>square a<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>square b<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                                        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">else</span>    <span class="org-rainbow-delimiters-depth-6">(</span>+ <span class="org-rainbow-delimiters-depth-7">(</span>square a<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>square c<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                  <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span>
                          <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>&gt; c a<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>+ <span class="org-rainbow-delimiters-depth-7">(</span>square b<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>square c<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                                    <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">else</span>    <span class="org-rainbow-delimiters-depth-6">(</span>+ <span class="org-rainbow-delimiters-depth-7">(</span>square b<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>square a<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">; </span><span class="org-comment">a nicer way</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum-of-square</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span>+ <span class="org-rainbow-delimiters-depth-3">(</span>square x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>square y<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">bigger</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; x y<span class="org-rainbow-delimiters-depth-3">)</span>
                x
                y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">smaller</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; x y<span class="org-rainbow-delimiters-depth-3">)</span>
                x
                y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum-sqr-big-1</span> a b c<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span>sum-of-square <span class="org-rainbow-delimiters-depth-3">(</span>bigger a b<span class="org-rainbow-delimiters-depth-3">)</span>
                                   <span class="org-rainbow-delimiters-depth-3">(</span>bigger <span class="org-rainbow-delimiters-depth-4">(</span>smaller a b<span class="org-rainbow-delimiters-depth-4">)</span> c<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Exercise 1.4</h2>
<div class="outline-text-2" id="text-4">
<p>
<code>((if (&gt; b 0) + -) a b)</code>
</p>
<ul class="org-ul">
<li>if b &gt; 0, then + is the operator and thus a + b is performed.
</li>
<li>otherwise, a - b is performed.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Exercise 1.5</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>For applicative-order evaluation, it'll enter a infinite loop. Because firstly interpreter will try to substitute (p) by (p) according to the definiton, but this will never end.
</li>
<li>For normal-order evaluation, the result is 0.
</li>
</ul>
<p>
<code>(test 0 (p))</code> will be interpret as <code>(if (= 0 0) 0 (p))</code> and then 0, because the predicate expression is evaluated first, (p) will never be substitute.
</p>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Exercise 1.6</h2>
<div class="outline-text-2" id="text-6">
<p>
Unfortunately, this <code>new-if</code> doesn't work as the special form <code>if</code>
does. The <code>new-if</code>, under current context, is no more than a
predefined procedure. So it'will behave just like other procedures :
calculate the value of the operands and then use these values to do
the procedures. No matter what result the predicate will produce, the
then-clause and the else-clause both get evaluated.
</p>

<p>
In the <code>sqrt-iter</code> program, use the <code>new-if</code> will cause the program to
run forever. The evaluation of <code>sqrt-root</code> will never end.
</p>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Exercise 1.7</h2>
<div class="outline-text-2" id="text-7">
<p>
Use the code in the book, when calculating square root of small
numbers, like 0.0009, the interpreter output 0.04.
</p>

<p>
Instead of setting the absolute value that the answer's square and
radicand differs, we can use a value to restrict the ratio of the
error, say, 0.1%.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"square-root.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">good-enough?</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>&lt; <span class="org-rainbow-delimiters-depth-3">(</span>abs <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>-
              <span class="org-rainbow-delimiters-depth-6">(</span>square guess<span class="org-rainbow-delimiters-depth-6">)</span>
              x<span class="org-rainbow-delimiters-depth-5">)</span>
             x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
     0.001<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Using the new <code>good-enough</code> test, now the program
can produce answer much more accurate. For 0.0009,
the answer is 3.0000012746348552e-2.
</p>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> Exercise 1.8</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-comment-delimiter">;; </span><span class="org-comment">Newton's method for cube roots</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">improve</span> y x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>/ <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>/ x
           <span class="org-rainbow-delimiters-depth-5">(</span>square y<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>* 2 y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
     3<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cube</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x <span class="org-rainbow-delimiters-depth-3">(</span>square x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">good-enough?</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>&lt; <span class="org-rainbow-delimiters-depth-3">(</span>/ <span class="org-rainbow-delimiters-depth-4">(</span>abs <span class="org-rainbow-delimiters-depth-5">(</span>- <span class="org-rainbow-delimiters-depth-6">(</span>cube guess<span class="org-rainbow-delimiters-depth-6">)</span>
                x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        x<span class="org-rainbow-delimiters-depth-3">)</span>
     0.001<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cube-iter</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>good-enough? guess x<span class="org-rainbow-delimiters-depth-3">)</span>
      guess
      <span class="org-rainbow-delimiters-depth-3">(</span>cube-iter <span class="org-rainbow-delimiters-depth-4">(</span>improve guess x<span class="org-rainbow-delimiters-depth-4">)</span> x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cube-root</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>cube-iter 1.0 x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Exercise 1.9</h2>
<div class="outline-text-2" id="text-9">
<ul class="org-ul">
<li>The first one :
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ 4 5<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>+ 3 5<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc <span class="org-rainbow-delimiters-depth-3">(</span>+ 2 5<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc <span class="org-rainbow-delimiters-depth-3">(</span>inc <span class="org-rainbow-delimiters-depth-4">(</span>+ 1 5<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc <span class="org-rainbow-delimiters-depth-3">(</span>inc <span class="org-rainbow-delimiters-depth-4">(</span>inc <span class="org-rainbow-delimiters-depth-5">(</span>+ 0 5<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc <span class="org-rainbow-delimiters-depth-3">(</span>inc <span class="org-rainbow-delimiters-depth-4">(</span>inc 5<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc <span class="org-rainbow-delimiters-depth-3">(</span>inc 6<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc <span class="org-rainbow-delimiters-depth-2">(</span>inc 7<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>inc 8<span class="org-rainbow-delimiters-depth-1">)</span>
9
</pre>
</div>
<p>
As we can see, this process fully expands then contracts and
the length of the chain of deferred <code>inc</code> operations, with the
amount of information needed to keep track of it, grows linearly
with n. Therefore it's a linear recursive process.
</p>
</li>
<li>The second one:
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ 4 5<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 3 6<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 2 7<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 1 8<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 0 9<span class="org-rainbow-delimiters-depth-1">)</span>
9
</pre>
</div>
<p>
This process does not grow and shrink, it's a linear iterative
process.
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> Exercise 1.10</h2>
<div class="outline-text-2" id="text-10">
<p>
Use mathematical stuff, we can say that A is some kind of function
f, s.t.,
</p>
<ul class="org-ul">
<li>f(anyvalue, 0) = 0
</li>
<li>f(0, anyvalue) = 2 * anyvalue
</li>
<li>f(anyvalue, 1) = 2
</li>
<li>otherwise, f(x, y) = f(x-1, f(x, y-1))
</li>
</ul>
<p>
Using substitution model,
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-comment-delimiter">;; </span><span class="org-comment">process (A 1 10)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 10<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 9<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 1 8<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 1 7<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 1 6<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 1 5<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 1 4<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 <span class="org-rainbow-delimiters-depth-8">(</span>A 1 3<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 <span class="org-rainbow-delimiters-depth-8">(</span>A 0 <span class="org-rainbow-delimiters-depth-9">(</span>A 1 2<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 <span class="org-rainbow-delimiters-depth-8">(</span>A 0 <span class="org-rainbow-delimiters-depth-9">(</span>A 0 <span class="org-rainbow-delimiters-depth-1">(</span>A 1 1<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 <span class="org-rainbow-delimiters-depth-8">(</span>A 0 <span class="org-rainbow-delimiters-depth-9">(</span>A 0 2<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 <span class="org-rainbow-delimiters-depth-8">(</span>A 0 4<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 0 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 0 <span class="org-rainbow-delimiters-depth-5">(</span>A 0 <span class="org-rainbow-delimiters-depth-6">(</span>A 0 <span class="org-rainbow-delimiters-depth-7">(</span>A 0 8<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
   ...
   ...
1024 <span class="org-comment-delimiter">; </span><span class="org-comment">2 to the power of 10</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">seems f(1, n) = 2^n for n &gt; 0</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">(A 2 4)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 2 4<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 2 3<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 <span class="org-rainbow-delimiters-depth-3">(</span>A 2 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 <span class="org-rainbow-delimiters-depth-3">(</span>A 1 <span class="org-rainbow-delimiters-depth-4">(</span>A 2 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 <span class="org-rainbow-delimiters-depth-3">(</span>A 1 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 <span class="org-rainbow-delimiters-depth-4">(</span>A 1 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 <span class="org-rainbow-delimiters-depth-3">(</span>A 0 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 1 4<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 <span class="org-rainbow-delimiters-depth-3">(</span>A 1 3<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 <span class="org-rainbow-delimiters-depth-2">(</span>A 0 8<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 1 16<span class="org-rainbow-delimiters-depth-1">)</span>
65536 <span class="org-comment-delimiter">; </span><span class="org-comment">2^16</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">notice the pattern here, f(2, n) = f(1, f(2, n-1)) = 2^f(2, n-1)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>A 3 3<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 2 <span class="org-rainbow-delimiters-depth-2">(</span>A 3 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 2 <span class="org-rainbow-delimiters-depth-2">(</span>A 2 <span class="org-rainbow-delimiters-depth-3">(</span>A 3 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 2 <span class="org-rainbow-delimiters-depth-2">(</span>A 2 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>A 2 4<span class="org-rainbow-delimiters-depth-1">)</span>
65536
<span class="org-comment-delimiter">;; </span><span class="org-comment">f(3, n) = f(2, f(3, n-1))</span>
</pre>
</div>
<p>
It's easy to see that,
</p>
<ul class="org-ul">
<li><code>(f n)</code> computes 2*n
</li>
<li><code>(g n)</code> computes 2<sup>n</sup>
</li>
<li><code>(h n)</code> computes 2<sup>2<sup>&#x2026;</sup></sup>, n layers of exponent.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> Exercise 1.11</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-comment-delimiter">;; </span><span class="org-comment">recursive</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f-recursive</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>f-rec-iter n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f-rec-iter</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&lt; n 3<span class="org-rainbow-delimiters-depth-4">)</span> n<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ <span class="org-rainbow-delimiters-depth-5">(</span>f-rec-iter <span class="org-rainbow-delimiters-depth-6">(</span>- n 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                 <span class="org-rainbow-delimiters-depth-5">(</span>* 2
                    <span class="org-rainbow-delimiters-depth-6">(</span>f-rec-iter <span class="org-rainbow-delimiters-depth-7">(</span>- n 2<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                 <span class="org-rainbow-delimiters-depth-5">(</span>* 3
                    <span class="org-rainbow-delimiters-depth-6">(</span>f-rec-iter <span class="org-rainbow-delimiters-depth-7">(</span>- n 3<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">iterative</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f-iterative</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>f-iter-iter 2 1 0 n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f-iter-iter</span> a b c count<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= count 0<span class="org-rainbow-delimiters-depth-3">)</span>
      c
      <span class="org-rainbow-delimiters-depth-3">(</span>f-iter-iter <span class="org-rainbow-delimiters-depth-4">(</span>+ a
                      <span class="org-rainbow-delimiters-depth-5">(</span>* 2 b<span class="org-rainbow-delimiters-depth-5">)</span>
                      <span class="org-rainbow-delimiters-depth-5">(</span>* 3 c<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                   a
                   b
                   <span class="org-rainbow-delimiters-depth-4">(</span>- count 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
running the recursive version with n = 100 is like forever&#x2026;Yet the
iterative version immediately return the answer.
</p>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> Exercise 1.12</h2>
<div class="outline-text-2" id="text-12">
<p>
The procedure <code>(pascal row col)</code> gives the element at the
corresponding row and column.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-comment-delimiter">;; </span><span class="org-comment">recursive</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pascal</span> row col<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">or</span> <span class="org-rainbow-delimiters-depth-4">(</span>= row 0<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= row 1<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= col 0<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= row col<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      1
      <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>pascal <span class="org-rainbow-delimiters-depth-5">(</span>- row 1<span class="org-rainbow-delimiters-depth-5">)</span>
                 <span class="org-rainbow-delimiters-depth-5">(</span>- col 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>pascal <span class="org-rainbow-delimiters-depth-5">(</span>- row 1<span class="org-rainbow-delimiters-depth-5">)</span>
                 col<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">iterative, a little mathematics</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pascal-iter</span> row col<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">or</span> <span class="org-rainbow-delimiters-depth-4">(</span>= row 0<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= col 0<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= row 1<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>= row col<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      1
      <span class="org-rainbow-delimiters-depth-3">(</span>pascal-iter-iter row 1 row col<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">this looks a little bit weird because I just don't wanna calculate the factorials</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pascal-iter-iter</span> row deno num count<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= count 1<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">do the division when count hits 1</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>/ num deno<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>pascal-iter-iter <span class="org-rainbow-delimiters-depth-4">(</span>- row 1<span class="org-rainbow-delimiters-depth-4">)</span>
                        <span class="org-rainbow-delimiters-depth-4">(</span>* deno count<span class="org-rainbow-delimiters-depth-4">)</span>
                        <span class="org-rainbow-delimiters-depth-4">(</span>* num
                           <span class="org-rainbow-delimiters-depth-5">(</span>- row 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                        <span class="org-rainbow-delimiters-depth-4">(</span>- count 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> Exercise 1.13</h2>
<div class="outline-text-2" id="text-13">
<p>
Just prove \(\vert \frac{\psi^n}{\sqrt{5}}\vert < 0.5\).
</p>
</div>
</div>
<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> Exercise 1.14</h2>
<div class="outline-text-2" id="text-14">

<div class="figure">
<p><img src="http://sicp.readthedocs.io/en/latest/_images/14.png" alt="14.png" width="916px" height="696px" />
</p>
<p><span class="figure-number">Figure 1:</span> from <a href="http://sicp.readthedocs.io/en/latest/_images/14.png">readthedocs</a></p>
</div>
</div>
</div>
<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> Exercise 1.15</h2>
<div class="outline-text-2" id="text-15">
</div><div id="outline-container-sec-15-1" class="outline-3">
<h3 id="sec-15-1"><span class="section-number-3">15.1</span> a</h3>
<div class="outline-text-3" id="text-15-1">
<p>
Whenever angle is greater than 0.1, <code>p</code> will be called. 12.15 -&gt;
4.05 -&gt; 1.35 -&gt; 0.45 -&gt; 0.15 -&gt; 0.05 -&gt; backtracking, so <code>p</code> is
applied 5 times.
</p>

<p>
On the other hand, we can use <code>trace-entry</code> to trace the procedure
p.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">[</span>Entering #<span class="org-rainbow-delimiters-depth-2">[</span>compound-procedure 2 p<span class="org-rainbow-delimiters-depth-2">]</span>
    Args: 4.9999999999999996e-2<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">[</span>Entering #<span class="org-rainbow-delimiters-depth-2">[</span>compound-procedure 2 p<span class="org-rainbow-delimiters-depth-2">]</span>
    Args: .1495<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">[</span>Entering #<span class="org-rainbow-delimiters-depth-2">[</span>compound-procedure 2 p<span class="org-rainbow-delimiters-depth-2">]</span>
    Args: .4351345505<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">[</span>Entering #<span class="org-rainbow-delimiters-depth-2">[</span>compound-procedure 2 p<span class="org-rainbow-delimiters-depth-2">]</span>
    Args: .9758465331678772<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">[</span>Entering #<span class="org-rainbow-delimiters-depth-2">[</span>compound-procedure 2 p<span class="org-rainbow-delimiters-depth-2">]</span>
    Args: -.7895631144708228<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: -.39980345741334</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-15-2" class="outline-3">
<h3 id="sec-15-2"><span class="section-number-3">15.2</span> b</h3>
<div class="outline-text-3" id="text-15-2">
<p>
Every time the angle will be divided by 3 and it's a recursive
procedure, the space and time complexity are all \(O(\log_3a)\).
</p>
</div>
</div>
</div>
<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> Exercise 1.16</h2>
<div class="outline-text-2" id="text-16">
<p>
The strategy is:
</p>
<ul class="org-ul">
<li>if <code>n</code> is even, then we call the iterative procedure on squared <code>b</code>
  and halved <code>n</code>
</li>
<li>else we update a to a times b, and call the iterative procedure on
squared <code>b</code> and halved <code>n-1</code>.
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fast-expt</span> b n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>fast-expt-iter 1 b n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fast-expt-iter</span> a b n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= n 0<span class="org-rainbow-delimiters-depth-4">)</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? n<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>fast-expt-iter a
                                   <span class="org-rainbow-delimiters-depth-5">(</span>* b b<span class="org-rainbow-delimiters-depth-5">)</span>
                                   <span class="org-rainbow-delimiters-depth-5">(</span>/ n 2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>fast-expt-iter <span class="org-rainbow-delimiters-depth-5">(</span>* a b<span class="org-rainbow-delimiters-depth-5">)</span>
                              <span class="org-rainbow-delimiters-depth-5">(</span>* b b<span class="org-rainbow-delimiters-depth-5">)</span>
                              <span class="org-rainbow-delimiters-depth-5">(</span>/ <span class="org-rainbow-delimiters-depth-6">(</span>- n 1<span class="org-rainbow-delimiters-depth-6">)</span> 2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> Exercise 1.17</h2>
</div>
<div id="outline-container-sec-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> Exercise 1.18</h2>
<div class="outline-text-2" id="text-18">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">double</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>+ n n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">halve</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>/ n 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">recursive</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">x-recursive</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; b 0<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>- <span class="org-rainbow-delimiters-depth-4">(</span>x-recursive-iter a
                           <span class="org-rainbow-delimiters-depth-5">(</span>abs b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>x-recursive-iter a b<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">x-recursive-iter</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= b 1<span class="org-rainbow-delimiters-depth-4">)</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? b<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>double <span class="org-rainbow-delimiters-depth-5">(</span>x-recursive-iter a <span class="org-rainbow-delimiters-depth-6">(</span>halve b<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ a <span class="org-rainbow-delimiters-depth-5">(</span>x-recursive-iter a <span class="org-rainbow-delimiters-depth-6">(</span>- b 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">iterative</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">x-iterative</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; b 0<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>- <span class="org-rainbow-delimiters-depth-4">(</span>x-iter 0 a <span class="org-rainbow-delimiters-depth-5">(</span>abs b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>x-iter 0 a b<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">x-iter</span> n a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= b 0<span class="org-rainbow-delimiters-depth-4">)</span> n<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? b<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>x-iter n
                           <span class="org-rainbow-delimiters-depth-5">(</span>double a<span class="org-rainbow-delimiters-depth-5">)</span>
                           <span class="org-rainbow-delimiters-depth-5">(</span>halve b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>x-iter <span class="org-rainbow-delimiters-depth-5">(</span>+ n a<span class="org-rainbow-delimiters-depth-5">)</span>
                      a
                      <span class="org-rainbow-delimiters-depth-5">(</span>- b 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Note that we have to handle the case when b is negative.
</p>
</div>
</div>
<div id="outline-container-sec-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> Exercise 1.19</h2>
<div class="outline-text-2" id="text-19">
<p>
By applying the transform \(T_{pq}\) twice, we can derive that the new
transform \(T_{p'q'}\):
</p>
\begin{align*}
a &\leftarrow b(2pq+q^2) + a(2pq+q^2) + a(p^2+q^2) \\
b &\leftarrow b(p^2+q^2) + a(2pq+q^2)
\end{align*}
<p>
therefore,
</p>
\begin{align*}
p' &= p^2 + q^2 \\
q' &= 2pq + q^2
\end{align*}

<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fib</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>fib-iter 1 0 0 1 n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fib-iter</span> a b p q count<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= count 0<span class="org-rainbow-delimiters-depth-4">)</span> b<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? count<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>fib-iter a
                   b
                   <span class="org-rainbow-delimiters-depth-5">(</span>+ <span class="org-rainbow-delimiters-depth-6">(</span>square p<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>square q<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                   <span class="org-rainbow-delimiters-depth-5">(</span>+ <span class="org-rainbow-delimiters-depth-6">(</span>square q<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>* 2 p q<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                   <span class="org-rainbow-delimiters-depth-5">(</span>/ count 2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>fib-iter <span class="org-rainbow-delimiters-depth-5">(</span>+ <span class="org-rainbow-delimiters-depth-6">(</span>* b q<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>* a q<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>* a p<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                        <span class="org-rainbow-delimiters-depth-5">(</span>+ <span class="org-rainbow-delimiters-depth-6">(</span>* b p<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>* a q<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                        p
                        q
                        <span class="org-rainbow-delimiters-depth-5">(</span>- count 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> Exercise 1.20</h2>
<div class="outline-text-2" id="text-20">
<p>
For applicative order substitution, 4 times.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>gcd 206 40<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">(gcd 40 (remainder 206 40))</span>
<span class="org-rainbow-delimiters-depth-1">(</span>gcd 40 6<span class="org-rainbow-delimiters-depth-1">)</span>   <span class="org-comment-delimiter">;</span><span class="org-comment">(gcd 6 (remainder 40 6))</span>
<span class="org-rainbow-delimiters-depth-1">(</span>gcd 6 4<span class="org-rainbow-delimiters-depth-1">)</span>    <span class="org-comment-delimiter">;</span><span class="org-comment">(gcd 4 (remainder 6 4))</span>
<span class="org-rainbow-delimiters-depth-1">(</span>gcd 4 2<span class="org-rainbow-delimiters-depth-1">)</span>    <span class="org-comment-delimiter">;</span><span class="org-comment">(gcd 2 (remainder 4 2))</span>
<span class="org-rainbow-delimiters-depth-1">(</span>gcd 2 0<span class="org-rainbow-delimiters-depth-1">)</span>    <span class="org-comment-delimiter">;</span><span class="org-comment">no remainder call</span>
2
</pre>
</div>
<p>
For normal order, use the following symbols to track the process,
</p>
<ul class="org-ul">
<li>t1 = (remainder 206 40) = 6, evaluation needs call <code>remainder</code> 1 time.
</li>
<li>t2 = (remainder 40 t1) = 4, 2 times.
</li>
<li>t3 = (remainder t1 t2) = 2, 4 times.
</li>
<li>t4 = (remainder t2 t3) = 0, 7 times.
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>gcd 206 40<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>gcd 40 t1<span class="org-rainbow-delimiters-depth-1">)</span>

if <span class="org-rainbow-delimiters-depth-1">(</span>= t1 0<span class="org-rainbow-delimiters-depth-1">)</span>   <span class="org-comment-delimiter">;; </span><span class="org-comment">#f +1</span>

<span class="org-rainbow-delimiters-depth-1">(</span>gcd t1 t2<span class="org-rainbow-delimiters-depth-1">)</span>

if <span class="org-rainbow-delimiters-depth-1">(</span>= t2 0<span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">#f +2</span>

<span class="org-rainbow-delimiters-depth-1">(</span>gcd t2 t3<span class="org-rainbow-delimiters-depth-1">)</span>

if <span class="org-rainbow-delimiters-depth-1">(</span>= t3 0<span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">#f +4</span>

<span class="org-rainbow-delimiters-depth-1">(</span>gcd t3 t4<span class="org-rainbow-delimiters-depth-1">)</span>

if <span class="org-rainbow-delimiters-depth-1">(</span>= t4 0<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">#t +7</span>

t3     <span class="org-comment-delimiter">;; </span><span class="org-comment">+4</span>
</pre>
</div>
<p>
18 times in total.
</p>
</div>
</div>
<div id="outline-container-sec-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> Exercise 1.21</h2>
<div class="outline-text-2" id="text-21">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">square</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">next-divisor</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 2<span class="org-rainbow-delimiters-depth-3">)</span>
      3
      <span class="org-rainbow-delimiters-depth-3">(</span>+ n 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">smallest-divisor</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>find-divisor n 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">find-divisor</span> n test-divisor<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&gt; <span class="org-rainbow-delimiters-depth-5">(</span>square test-divisor<span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span> n<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>divides? test-divisor n<span class="org-rainbow-delimiters-depth-4">)</span> test-divisor<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>find-divisor n <span class="org-rainbow-delimiters-depth-5">(</span>next-divisor test-divisor<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">divides?</span> a b<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder b a<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">prime?</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>= n <span class="org-rainbow-delimiters-depth-3">(</span>smallest-divisor n<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>smallest-divisor 199<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 199</span>

1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>smallest-divisor 1999<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1999</span>

1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>smallest-divisor 19999<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 7</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> Exercise 1.22</h2>
<div class="outline-text-2" id="text-22">
<p>
We make some modifications to time-prime-test procedure so that it
only print out prime numbers. Use
<code>real-time-clock</code> to get the current time in miliseconds rather than
<code>runtime</code> (in seconds).
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"smallest-divisor.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">time-prime-test</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>start-prime-test n <span class="org-rainbow-delimiters-depth-3">(</span>real-time-clock<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">start-prime-test</span> n start-time<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>prime? n<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>report-prime n <span class="org-rainbow-delimiters-depth-4">(</span>- <span class="org-rainbow-delimiters-depth-5">(</span>real-time-clock<span class="org-rainbow-delimiters-depth-5">)</span> start-time<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">report-prime</span> n elapsed-time<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>newline<span class="org-rainbow-delimiters-depth-2">)(</span>display n<span class="org-rainbow-delimiters-depth-2">)</span>  <span class="org-rainbow-delimiters-depth-2">(</span>display <span class="org-string">" *** "</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>display elapsed-time<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">search-for-primes</span> start end<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; start end<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>even? start<span class="org-rainbow-delimiters-depth-5">)</span>
             <span class="org-rainbow-delimiters-depth-5">(</span>search-for-primes <span class="org-rainbow-delimiters-depth-6">(</span>+ start 1<span class="org-rainbow-delimiters-depth-6">)</span> end<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-5">(</span>time-prime-test start<span class="org-rainbow-delimiters-depth-5">)</span>
                  <span class="org-rainbow-delimiters-depth-5">(</span>search-for-primes <span class="org-rainbow-delimiters-depth-6">(</span>+ start 2<span class="org-rainbow-delimiters-depth-6">)</span>
                                     end<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 1000 1020<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 10000 10038<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 100000 100044<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 1000000 1000038<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 1000000000 1000000022<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 10000000000 10000000062<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 100000000000 100000000058<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>search-for-primes 1000000000000 1000000000064<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Searching for small prime numbers is really fast, it's hard to see the
difference. When searching big prime numbers, the growth of the time
cost conforms to growth of \(\sqrt(10)\).
</p>
<div class="org-src-container">

<pre class="src src-scheme">1009 *** 0
1013 *** 0
1019 *** 0
10007 *** 0
10009 *** 1
10037 *** 0
100003 *** 0
100019 *** 1
100043 *** 0
1000003 *** 2
1000033 *** 2
1000037 *** 1
1000000007 *** 39
1000000009 *** 53
1000000021 *** 36
10000000019 *** 102
10000000033 *** 107
10000000061 *** 110
100000000003 *** 337
100000000019 *** 326
100000000057 *** 327
1000000000039 *** 1048
1000000000061 *** 1035
1000000000063 *** 1036
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> Exercise 1.23</h2>
<div class="outline-text-2" id="text-23">
<div class="org-src-container">

<pre class="src src-scheme">1009 *** 0
1013 *** 0
1019 *** 0
10007 *** 0
10009 *** 0
10037 *** 0
100003 *** 0
100019 *** 0
100043 *** 0
1000003 *** 1
1000033 *** 1
1000037 *** 1
1000000007 *** 22
1000000009 *** 25
1000000021 *** 23
10000000019 *** 64
10000000033 *** 69
10000000061 *** 71
100000000003 *** 205
100000000019 *** 208
100000000057 *** 213
1000000000039 *** 673
1000000000061 *** 658
1000000000063 *** 654
</pre>
</div>
<p>
Compared with exercise 1.22, we can find that the
<code>next</code> did bring some improvements, but not exactly
halved the running time. Well, my point is, the
exact executing time of the algorithm can be
affected by many other factors.
</p>
</div>
</div>
<div id="outline-container-sec-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> Exercise 1.24</h2>
<div class="outline-text-2" id="text-24">
<ol class="org-ol">
<li>fast prime:
</li>
</ol>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fermat-test</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">try-it</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>= <span class="org-rainbow-delimiters-depth-4">(</span>expmod a n n<span class="org-rainbow-delimiters-depth-4">)</span> a<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>try-it <span class="org-rainbow-delimiters-depth-3">(</span>+ 1 <span class="org-rainbow-delimiters-depth-4">(</span>random <span class="org-rainbow-delimiters-depth-5">(</span>- n 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fast-prime?</span> n times<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= times 0<span class="org-rainbow-delimiters-depth-4">)</span> true<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>fermat-test n<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>fast-prime? n <span class="org-rainbow-delimiters-depth-5">(</span>- times 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> false<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<ol class="org-ol">
<li>test
</li>
</ol>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"fast-prime.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">time-prime-test</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>start-prime-test n <span class="org-rainbow-delimiters-depth-3">(</span>real-time-clock<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">start-prime-test</span> n start-time<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>fast-prime? n 1000<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>report-prime n <span class="org-rainbow-delimiters-depth-4">(</span>- <span class="org-rainbow-delimiters-depth-5">(</span>real-time-clock<span class="org-rainbow-delimiters-depth-5">)</span> start-time<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">report-prime</span> n elapsed-time<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>newline<span class="org-rainbow-delimiters-depth-2">)(</span>display n<span class="org-rainbow-delimiters-depth-2">)</span>  <span class="org-rainbow-delimiters-depth-2">(</span>display <span class="org-string">" *** "</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>display elapsed-time<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000007<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000009<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000021<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 10000000019<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 10000000033<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 10000000061<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 100000000003<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 100000000019<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 100000000057<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000000039<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000000061<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>time-prime-test 1000000000063<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<ol class="org-ol">
<li>result
</li>
</ol>
<div class="org-src-container">

<pre class="src src-scheme">1000000007 *** 67
1000000009 *** 76
1000000021 *** 64
10000000019 *** 79
10000000033 *** 82
10000000061 *** 82
100000000003 *** 85
100000000019 *** 84
100000000057 *** 86
1000000000039 *** 87
1000000000061 *** 93
1000000000063 *** 94
</pre>
</div>
<p>
For every number, we run fermat test 1000 times
(just to make the time easier to compare). As we
can see, when the test number increase by 10
times, the extra time needed is approximately \(log
10\).
</p>
</div>
</div>
<div id="outline-container-sec-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> Exercise 1.25</h2>
<div class="outline-text-2" id="text-25">
<p>
Use the <code>fast-expt</code> procedure, a very large number
may be introduced to the function <code>remainder</code>, which
will definitely slow down the computation
markedly.
</p>
</div>
</div>
<div id="outline-container-sec-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> Exercise 1.26</h2>
<div class="outline-text-2" id="text-26">
<p>
Louis's approach doesn't introduce a \(\Theta(log n)\)
process, but rather a \(\Theta(n)\) process. Though
it does halve the <code>exp</code>, but the expmod has been
calculated twice.
</p>
</div>
</div>
<div id="outline-container-sec-27" class="outline-2">
<h2 id="sec-27"><span class="section-number-2">27</span> Exercise 1.27</h2>
<div class="outline-text-2" id="text-27">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">test-carmichael</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">test-iter</span> current<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>= current 1<span class="org-rainbow-delimiters-depth-5">)</span> true<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>= <span class="org-rainbow-delimiters-depth-6">(</span>expmod current n n<span class="org-rainbow-delimiters-depth-6">)</span> current<span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>test-iter <span class="org-rainbow-delimiters-depth-6">(</span>- current 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">else</span> false<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>display n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>test-iter <span class="org-rainbow-delimiters-depth-4">(</span>- n 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>display <span class="org-string">" Fooled.\n"</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>display <span class="org-string">" Not Fooled.\n"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">if the number really fool the test, then true is returned.</span>

<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 561<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 1105<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 1729<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 2465<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 2821<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>test-carmichael 6601<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
They really fooled the test!
</p>
<div class="org-src-container">

<pre class="src src-scheme">561 Fooled.
1105 Fooled.
1729 Fooled.
2465 Fooled.
2821 Fooled.
6601 Fooled.
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-28" class="outline-2">
<h2 id="sec-28"><span class="section-number-2">28</span> Exercise 1.28</h2>
<div class="outline-text-2" id="text-28">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">non-trivial-square-root?</span> num m<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>= num 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>= num <span class="org-rainbow-delimiters-depth-5">(</span>- m 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>= 1 <span class="org-rainbow-delimiters-depth-4">(</span>remainder
             <span class="org-rainbow-delimiters-depth-5">(</span>square num<span class="org-rainbow-delimiters-depth-5">)</span>
             m<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">expmod</span> base exp m<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= exp 0<span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? exp<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>non-trivial-square-root? base m<span class="org-rainbow-delimiters-depth-5">)</span>
             0
             <span class="org-rainbow-delimiters-depth-5">(</span>remainder
              <span class="org-rainbow-delimiters-depth-6">(</span>square
               <span class="org-rainbow-delimiters-depth-7">(</span>expmod base <span class="org-rainbow-delimiters-depth-8">(</span>/ exp 2<span class="org-rainbow-delimiters-depth-8">)</span> m<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
              m<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>remainder
          <span class="org-rainbow-delimiters-depth-5">(</span>* base
             <span class="org-rainbow-delimiters-depth-6">(</span>expmod base <span class="org-rainbow-delimiters-depth-7">(</span>- exp 1<span class="org-rainbow-delimiters-depth-7">)</span> m<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          m<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">miller-rabin-test</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>expmod <span class="org-rainbow-delimiters-depth-4">(</span>+ 1 <span class="org-rainbow-delimiters-depth-5">(</span>random <span class="org-rainbow-delimiters-depth-6">(</span>- n 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>- n 1<span class="org-rainbow-delimiters-depth-4">)</span> n<span class="org-rainbow-delimiters-depth-3">)</span> 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fast-prime?</span> n times<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= times 0<span class="org-rainbow-delimiters-depth-4">)</span> true<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>miller-rabin-test n<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>fast-prime? n <span class="org-rainbow-delimiters-depth-5">(</span>- times 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> false<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">do-test</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>display n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>fast-prime? n 50<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>display <span class="org-string">" is prime.\n"</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>display <span class="org-string">" is not a prime.\n"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 561<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 1105<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 1729<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 2465<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 2821<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 6601<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>display <span class="org-string">"test true primes\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 1000000007<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 1000000009<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 1000000021<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>do-test 10000000019<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
I did the test for 50 times, it worked quite well.
</p>
<div class="org-src-container">

<pre class="src src-scheme">561 is not a prime.
1105 is not a prime.
1729 is not a prime.
2465 is not a prime.
2821 is not a prime.
6601 is not a prime.
test true primes
1000000007 is prime.
1000000009 is prime.
1000000021 is prime.
10000000019 is prime.
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-29" class="outline-2">
<h2 id="sec-29"><span class="section-number-2">29</span> Exercise 1.29</h2>
<div class="outline-text-2" id="text-29">
<p>
Calculate the integral by Simpson's Rule:
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"sum-iter.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">simpson-integral</span> f a b n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">kh</span> k<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>* k
       <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>* <span class="org-rainbow-delimiters-depth-6">(</span>- b a<span class="org-rainbow-delimiters-depth-6">)</span> 1.0<span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">next-a</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>+ a <span class="org-rainbow-delimiters-depth-4">(</span>kh 2<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">a + 2 * h</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">term</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>f a<span class="org-rainbow-delimiters-depth-4">)</span>  <span class="org-comment-delimiter">; </span><span class="org-comment">y0</span>
       <span class="org-rainbow-delimiters-depth-4">(</span>* 4 <span class="org-rainbow-delimiters-depth-5">(</span>f <span class="org-rainbow-delimiters-depth-6">(</span>+ a <span class="org-rainbow-delimiters-depth-7">(</span>kh 1<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>   <span class="org-comment-delimiter">; </span><span class="org-comment">4y1</span>
       <span class="org-rainbow-delimiters-depth-4">(</span>f <span class="org-rainbow-delimiters-depth-5">(</span>next-a a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>   <span class="org-comment-delimiter">; </span><span class="org-comment">y2</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>* <span class="org-rainbow-delimiters-depth-3">(</span>/ <span class="org-rainbow-delimiters-depth-4">(</span>- b a<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>* n 3.0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
     <span class="org-rainbow-delimiters-depth-3">(</span>sum term a next-a b<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Compare the result with the integral function provided in the book:
</p>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>simpson-integral cube 0 1 100<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .25000000000000044</span>

1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>integral cube 0 1 0.01<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .24998750000000042</span>

1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>simpson-integral cube 0 1 1000<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .2500000000000006</span>

1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>integral cube 0 1 0.001<span class="org-rainbow-delimiters-unmatched">)</span>

<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .249999875000001</span>
</pre>
</div>
<p>
As we can see, the result calculated via Simpson's Rule is much more
precise (0.25 is the ultimate answer).
</p>
</div>
</div>
<div id="outline-container-sec-30" class="outline-2">
<h2 id="sec-30"><span class="section-number-2">30</span> Exercise 1.30</h2>
<div class="outline-text-2" id="text-30">
<p>
Fill in the blanks.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum</span> term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter</span> a result<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span>
        result
        <span class="org-rainbow-delimiters-depth-4">(</span>iter <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span>+ result <span class="org-rainbow-delimiters-depth-6">(</span>term a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>iter a 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-31" class="outline-2">
<h2 id="sec-31"><span class="section-number-2">31</span> Exercise 1.31</h2>
<div class="outline-text-2" id="text-31">
<p>
Firstly define the product procedure.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">product</span> term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
      1
      <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>term a<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>product term <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span> next b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Modified it to be a iterative process just like <code>sum</code>
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">product</span> factor a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter</span> a result<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span>
        result
        <span class="org-rainbow-delimiters-depth-4">(</span>iter <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span>* result
                 <span class="org-rainbow-delimiters-depth-6">(</span>factor a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>iter a 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Use the product procedure to calculate factorial and approximate \(\pi\),
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"product-iter.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">factorial</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>product id 1 inc n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pi</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">next</span> a<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>+ a 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">factor</span> n<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>- n 1<span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span>
       <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>+ n 1<span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>* 4.0
     <span class="org-rainbow-delimiters-depth-3">(</span>product factor 3 next n<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Calculating the \(\pi\) ! (use the iterative version, otherwise the
recursive depth may to too deep when n reaches numbers like 100000)
</p>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>pi 10<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 3.3023935500125976</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>pi 100<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 3.157339689217565</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>pi 1000<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 3.143163842419198</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>pi 10000<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 3.1417497371492673</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-32" class="outline-2">
<h2 id="sec-32"><span class="section-number-2">32</span> Exercise 1.32</h2>
<div class="outline-text-2" id="text-32">
<p>
It's getting more and more interesting! :).
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">accumulate</span> combiner null-value term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
      null-value
      <span class="org-rainbow-delimiters-depth-3">(</span>combiner <span class="org-rainbow-delimiters-depth-4">(</span>term a<span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-rainbow-delimiters-depth-4">(</span>accumulate combiner null-value term <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span> next b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">accumulate-iter</span> combiner null-value term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter</span> a result<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span>
        result
        <span class="org-rainbow-delimiters-depth-4">(</span>iter <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span>combiner <span class="org-rainbow-delimiters-depth-6">(</span>term a<span class="org-rainbow-delimiters-depth-6">)</span>
                        result<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>iter a null-value<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Once we have the implementation of <code>accumulate</code>, <code>sum</code> and <code>product</code> are
very easy to code!
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"accumulate.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum</span> term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>accumulate + 0 term a next b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">product</span> term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>accumulate * 1 term a next b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-33" class="outline-2">
<h2 id="sec-33"><span class="section-number-2">33</span> Exercise 1.33</h2>
<div class="outline-text-2" id="text-33">
<p>
We only need to make some minor modifications when use the combiner
to combine terms.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">filtered-accumulate</span> combiner filter null-value term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
      null-value
      <span class="org-rainbow-delimiters-depth-3">(</span>combiner <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>filter a<span class="org-rainbow-delimiters-depth-5">)</span>
                    <span class="org-rainbow-delimiters-depth-5">(</span>term a<span class="org-rainbow-delimiters-depth-5">)</span>
                    null-value<span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-rainbow-delimiters-depth-4">(</span>filtered-accumulate combiner filter null-value term <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span> next b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">filtered-accumulate-iter</span> combiner filter null-value term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter</span> a result<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-4">)</span>
        result
        <span class="org-rainbow-delimiters-depth-4">(</span>iter <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span>combiner <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-7">(</span>filter a<span class="org-rainbow-delimiters-depth-7">)</span>
                            <span class="org-rainbow-delimiters-depth-7">(</span>term a<span class="org-rainbow-delimiters-depth-7">)</span>
                            null-value<span class="org-rainbow-delimiters-depth-6">)</span>
                        result<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>iter a null-value<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Then we can solve the two problems.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"filtered-accumulate.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"smallest-divisor.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square-of-primes</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>filtered-accumulate + prime? 0 square a inc b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">product-of-relative-prime-less-than</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">filter</span> a<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-4">(</span>= <span class="org-rainbow-delimiters-depth-5">(</span>gcd a n<span class="org-rainbow-delimiters-depth-5">)</span> 1<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>&lt; a n<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>filtered-accumulate * filter 1 id 1 inc <span class="org-rainbow-delimiters-depth-3">(</span>- n 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-34" class="outline-2">
<h2 id="sec-34"><span class="section-number-2">34</span> Exercise 1.34</h2>
<div class="outline-text-2" id="text-34">
<p>
The interpreter will utter an error, because when we evaluate <code>(f f)</code>
, the interpreter will try to do the following
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>f f<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>f 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>2 2<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-comment-delimiter">; </span><span class="org-comment">object 2 is not applicable !</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-35" class="outline-2">
<h2 id="sec-35"><span class="section-number-2">35</span> Exercise 1.35</h2>
<div class="outline-text-2" id="text-35">
<p>
The golden ratio \(\varphi\) must satisfy the following equation:
\[
    \varphi^2 = \
varphi + 1
\]
Divides both side by \(\varphi\) (\(\varphi\) is a positive number),
\[
\varphi = 1 + \frac{1}{\varphi}
\]
Note that, this transfomation does converge (The monotone bounded
convergence theorem).
</p>

<p>
Use the following procedure to calculate the fixed point.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"fixed-point.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">golden-ratio</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>fixed-point <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span>
                 <span class="org-rainbow-delimiters-depth-4">(</span>+ 1
                    <span class="org-rainbow-delimiters-depth-5">(</span>/ 1 x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
               1.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; golden-ratio
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.6180339631667064</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-36" class="outline-2">
<h2 id="sec-36"><span class="section-number-2">36</span> Exercise 1.36</h2>
<div class="outline-text-2" id="text-36">
<p>
Print out the guess each time,
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">tolerance</span> 0.00001<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fixed-point</span> f first-guess<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">close-enough?</span> v1 v2<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>&lt; <span class="org-rainbow-delimiters-depth-4">(</span>abs <span class="org-rainbow-delimiters-depth-5">(</span>- v1 v2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
       tolerance<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">try</span> guess<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>display guess<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>newline<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next <span class="org-rainbow-delimiters-depth-6">(</span>f guess<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>close-enough? guess next <span class="org-rainbow-delimiters-depth-5">)</span>
          next
          <span class="org-rainbow-delimiters-depth-5">(</span>try next<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>try first-guess<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-schem">(load "fixed-point-verbose.scm")
(load "utils.scm") ; average
(define solve
  (fixed-point (lambda (x)
                 (/ (log 1000)
                    (log x)))
               2.0))

(define solve-with-average-damping
  (fixed-point (lambda (x)
                 (average x
                          (/ (log 1000)
                             (log x))))
               2.0))
</pre>
</div>
<p>
Take a look at the result
</p>
<div class="org-src-container">

<pre class="src src-scheme">2.
9.965784284662087
3.004472209841214
6.279195757507157
3.759850702401539
5.215843784925895
4.182207192401397
4.8277650983445906
4.387593384662677
4.671250085763899
4.481403616895052
4.6053657460929
4.5230849678718865
4.577114682047341
4.541382480151454
4.564903245230833
4.549372679303342
4.559606491913287
4.552853875788271
4.557305529748263
4.554369064436181
4.556305311532999
4.555028263573554
4.555870396702851
4.555315001192079
4.5556812635433275
4.555439715736846
4.555599009998291
4.555493957531389
4.555563237292884
4.555517548417651
4.555547679306398
4.555527808516254
4.555540912917957
2.
5.9828921423310435
4.922168721308343
4.628224318195455
4.568346513136242
4.5577305909237005
4.555909809045131
4.555599411610624
4.5555465521473675
</pre>
</div>
<p>
The version with average damping converges must faster!
</p>
</div>
</div>
<div id="outline-container-sec-37" class="outline-2">
<h2 id="sec-37"><span class="section-number-2">37</span> Exercise 1.37</h2>
<div class="outline-text-2" id="text-37">
<p>
For the recursive version, we must calculate it from outermost to
innermost. The iterative process just reverses.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cont-frac</span> n d k<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">frac</span> i<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>= i k<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>n i<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>d i<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>/ <span class="org-rainbow-delimiters-depth-5">(</span>n i<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>+ <span class="org-rainbow-delimiters-depth-6">(</span>d i<span class="org-rainbow-delimiters-depth-6">)</span>
                    <span class="org-rainbow-delimiters-depth-6">(</span>frac <span class="org-rainbow-delimiters-depth-7">(</span>+ i 1<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>frac 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cont-frac-iter</span> n d k<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter</span> i result<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>= i 0<span class="org-rainbow-delimiters-depth-4">)</span>
        result
        <span class="org-rainbow-delimiters-depth-4">(</span>iter <span class="org-rainbow-delimiters-depth-5">(</span>- i 1<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span>/ <span class="org-rainbow-delimiters-depth-6">(</span>n i<span class="org-rainbow-delimiters-depth-6">)</span>
                 <span class="org-rainbow-delimiters-depth-6">(</span>+ <span class="org-rainbow-delimiters-depth-7">(</span>d i<span class="org-rainbow-delimiters-depth-7">)</span> result<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>iter k 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Use the following procedure to do test
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"cont-frac.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">test</span> k<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">1 + 1/x</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>+ 1
     <span class="org-rainbow-delimiters-depth-3">(</span>cont-frac <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>i<span class="org-rainbow-delimiters-depth-5">)</span> 1.0<span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>i<span class="org-rainbow-delimiters-depth-5">)</span> 1.0<span class="org-rainbow-delimiters-depth-4">)</span>
                k<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>test 5<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.625</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>test 6<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.6153846153846154</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>test 10<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.6179775280898876</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>test 11<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.6180555555555556</span>
</pre>
</div>
<p>
When \(k \geq 11\), the approximation is accurate to 4 decimal places.
</p>
</div>
</div>
<div id="outline-container-sec-38" class="outline-2">
<h2 id="sec-38"><span class="section-number-2">38</span> Exercise 1.38</h2>
<div class="outline-text-2" id="text-38">
<p>
We only need a slightly different \(D_i\) function, s.t.
</p>
\begin{equation*}
    D_i =
    \begin{cases}
    2k, & \text{if}\ i = 3k - 1, k \in \mathbb{N}^+ \\
    1, & \text{otherwise}
    \end{cases}
\end{equation*}
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"cont-frac.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">approx</span> k<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>+ 2
     <span class="org-rainbow-delimiters-depth-3">(</span>cont-frac <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>i<span class="org-rainbow-delimiters-depth-5">)</span> 1.0<span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>i<span class="org-rainbow-delimiters-depth-5">)</span>
                  <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-6">(</span>= <span class="org-rainbow-delimiters-depth-7">(</span>remainder <span class="org-rainbow-delimiters-depth-8">(</span>+ i 1<span class="org-rainbow-delimiters-depth-8">)</span> 3<span class="org-rainbow-delimiters-depth-7">)</span> 0<span class="org-rainbow-delimiters-depth-6">)</span>
                      <span class="org-rainbow-delimiters-depth-6">(</span>* <span class="org-rainbow-delimiters-depth-7">(</span>/ <span class="org-rainbow-delimiters-depth-8">(</span>+ i 1<span class="org-rainbow-delimiters-depth-8">)</span> 3<span class="org-rainbow-delimiters-depth-7">)</span>
                         2<span class="org-rainbow-delimiters-depth-6">)</span>
                      1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                k<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>approx 1<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 3.</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>approx 2<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 2.6666666666666665</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>approx 5<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 2.71875</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>approx 4<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 2.7142857142857144</span>
</pre>
</div>
<p>
As we can see, it converges very fast (k = 5 produces accuracy for 4
decimal places)
</p>
</div>
</div>
<div id="outline-container-sec-39" class="outline-2">
<h2 id="sec-39"><span class="section-number-2">39</span> Exercise 1.39</h2>
<div class="outline-text-2" id="text-39">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"cont-frac.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">tan-cf</span> x k<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">N</span> i<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>= i 1<span class="org-rainbow-delimiters-depth-4">)</span>
        x
        <span class="org-rainbow-delimiters-depth-4">(</span>- <span class="org-rainbow-delimiters-depth-5">(</span>square x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">D</span> i<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>- <span class="org-rainbow-delimiters-depth-4">(</span>* 2 i<span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>exact-&gt;inexact <span class="org-rainbow-delimiters-depth-3">(</span>cont-frac N D k<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
We can compare the result with the built-in <code>tan</code>
</p>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>tan-cf 5 100<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: -3.380515006246586</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>tan 5<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: -3.380515006246585</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>tan-cf 22 100<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .00885165604168446</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>tan 22<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: .00885165604168446</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-40" class="outline-2">
<h2 id="sec-40"><span class="section-number-2">40</span> Exercise 1.40</h2>
<div class="outline-text-2" id="text-40">
<p>
Define <code>cubic</code> as a procedure with a,b,c as arguments and return a
procedure.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"newton.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cubic</span> a b c<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>cube x<span class="org-rainbow-delimiters-depth-4">)</span>
       <span class="org-rainbow-delimiters-depth-4">(</span>* a <span class="org-rainbow-delimiters-depth-5">(</span>square x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
       <span class="org-rainbow-delimiters-depth-4">(</span>* b x<span class="org-rainbow-delimiters-depth-4">)</span>
       c<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
run some tests.
</p>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>newtons-method <span class="org-rainbow-delimiters-depth-1">(</span>cubic 1 1 0<span class="org-rainbow-delimiters-depth-1">)</span> 1<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 1.7046374495392907e-18</span>
1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span>newtons-method <span class="org-rainbow-delimiters-unmatched">(</span>cubic 0 0 1<span class="org-rainbow-delimiters-unmatched">)</span> 1<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: -.9999999999999982</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-41" class="outline-2">
<h2 id="sec-41"><span class="section-number-2">41</span> Exercise 1.41</h2>
<div class="outline-text-2" id="text-41">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">double</span> g<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>g <span class="org-rainbow-delimiters-depth-4">(</span>g x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">1 <span class="org-rainbow-delimiters-unmatched">]</span>=&gt; <span class="org-rainbow-delimiters-unmatched">(</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>double <span class="org-rainbow-delimiters-depth-3">(</span>double double<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> inc<span class="org-rainbow-delimiters-depth-1">)</span> 5<span class="org-rainbow-delimiters-unmatched">)</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">Value: 21</span>
</pre>
</div>
<p>
As we can see, the result is 5 + 16 = 21, so it apply the procedure
<code>inc</code> 16 times.
</p>

<p>
Let me explain this. <code>(double double)</code> gives us a procedure that
apply <code>double</code> twice, so <code>(double (double double))</code> gives us a procedure
that apply <code>double</code> 4 times. So we are gonna double <code>inc</code> 4 times. That
is, \(1 * 2 * 2 * 2 * 2 = 16\).
</p>
</div>
</div>
<div id="outline-container-sec-42" class="outline-2">
<h2 id="sec-42"><span class="section-number-2">42</span> Exercise 1.42</h2>
<div class="outline-text-2" id="text-42">
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">compose</span> f g<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>f <span class="org-rainbow-delimiters-depth-4">(</span>g x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-43" class="outline-2">
<h2 id="sec-43"><span class="section-number-2">43</span> Exercise 1.43</h2>
<div class="outline-text-2" id="text-43">
<p>
Using the <code>compose</code> procedure above, this is a piece of cake.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"compose.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">repeat</span> f n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 0<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span> x<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>compose f <span class="org-rainbow-delimiters-depth-4">(</span>repeat f <span class="org-rainbow-delimiters-depth-5">(</span>- n 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-44" class="outline-2">
<h2 id="sec-44"><span class="section-number-2">44</span> Exercise 1.44</h2>
<div class="outline-text-2" id="text-44">
<p>
(load "compose.scm")
(load "repeat.scm")
(load "utils.scm")
(define dx 0.000001)
(define (smooth f)
  (lambda (x)
    (/ (+ (f (- x dx)) (f x) (f (+ x dx)))
       3.0)))
</p>

<p>
(define (n-fold-smooth f n)
  ((repeat smooth n) f))
</p>
</div>
</div>
<div id="outline-container-sec-45" class="outline-2">
<h2 id="sec-45"><span class="section-number-2">45</span> Exercise 1.45</h2>
<div class="outline-text-2" id="text-45">
<p>
Here we use <code>repeat</code> procedure to define a exp function
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"repeat.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">expt</span> base n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 0<span class="org-rainbow-delimiters-depth-3">)</span>
      1
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>repeat <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-6">(</span>x<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>* x base<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">x^n = x * x * x * ... * 1</span>
</pre>
</div>
<p>
Then define the procedure to damp a function n times
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"repeat.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">average-damping</span> f<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>average x <span class="org-rainbow-delimiters-depth-4">(</span>f x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">n-average-damping</span> f n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>repeat average-damping n<span class="org-rainbow-delimiters-depth-3">)</span> f<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Now we need a function s.t., with take n and times as arguments,
return a function that can calculate the n-th roots of inputs with
<code>times</code> average damping
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"damping.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"fixed-point.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">damped-nth-root</span> n times<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>fixed-point
     <span class="org-rainbow-delimiters-depth-4">(</span>n-average-damping <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-6">(</span>y<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>/ x <span class="org-rainbow-delimiters-depth-7">(</span>expt y <span class="org-rainbow-delimiters-depth-8">(</span>- n 1<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                        times<span class="org-rainbow-delimiters-depth-4">)</span>
     1.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
So we need to do some experiments to find out how many times of
damping are needed for calculating n-th root.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="left" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">n</th>
<th scope="col" class="right">2</th>
<th scope="col" class="right">3</th>
<th scope="col" class="right">4</th>
<th scope="col" class="right">5</th>
<th scope="col" class="right">6</th>
<th scope="col" class="right">7</th>
<th scope="col" class="right">8</th>
<th scope="col" class="right">9</th>
<th scope="col" class="left">&#x2026;</th>
<th scope="col" class="right">16</th>
<th scope="col" class="left">&#x2026;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">damping times</td>
<td class="right">1</td>
<td class="right">1</td>
<td class="right">2</td>
<td class="right">2</td>
<td class="right">2</td>
<td class="right">2</td>
<td class="right">3</td>
<td class="right">3</td>
<td class="left">&#x2026;</td>
<td class="right">4</td>
<td class="left">&#x2026;</td>
</tr>
</tbody>
</table>

<p>
As we can see, the minimum times of damping for the n-th root fixed point
iteration to converge is \(\lfloor \lg n\rfloor\).
</p>

<p>
We need a \(\lg\) function.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">lg</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; x 2<span class="org-rainbow-delimiters-depth-3">)</span>
      0
      <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>lg <span class="org-rainbow-delimiters-depth-5">(</span>/ x 2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Using procedures defined above, now we can finally get a generic
procedure for find n-th root
(load "lg.scm")
(load "ex1-44.scm")
</p>

<p>
(define (nth-root n)
  (damped-nth-root n (lg n)))
</p>
</div>
</div>
<div id="outline-container-sec-46" class="outline-2">
<h2 id="sec-46"><span class="section-number-2">46</span> Exercise 1.46</h2>
<div class="outline-text-2" id="text-46">
<p>
The <code>iterative-improve</code> procedure
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">iterative-improve</span> good-enough? improve<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">iter-improve</span> guess<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>good-enough? guess<span class="org-rainbow-delimiters-depth-4">)</span>
        guess
        <span class="org-rainbow-delimiters-depth-4">(</span>iter-improve <span class="org-rainbow-delimiters-depth-5">(</span>improve guess<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  iter-improve<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
<p>
Then we can redefine the <code>sqrt</code> and <code>fixed-point</code> procedure.
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"iter-improve.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"utils.scm"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">tolerance</span> 0.0000001<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sqrt</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>iterative-improve <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>x<span class="org-rainbow-delimiters-depth-5">)</span>
                       <span class="org-rainbow-delimiters-depth-5">(</span>&lt; <span class="org-rainbow-delimiters-depth-6">(</span>abs <span class="org-rainbow-delimiters-depth-7">(</span>- <span class="org-rainbow-delimiters-depth-8">(</span>square x<span class="org-rainbow-delimiters-depth-8">)</span> n<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> tolerance<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>x<span class="org-rainbow-delimiters-depth-5">)</span>
                       <span class="org-rainbow-delimiters-depth-5">(</span>average x <span class="org-rainbow-delimiters-depth-6">(</span>/ n x<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   1.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fixed-point</span> f first-guess<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>iterative-improve <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>v<span class="org-rainbow-delimiters-depth-5">)</span>
                        <span class="org-rainbow-delimiters-depth-5">(</span>&lt; <span class="org-rainbow-delimiters-depth-6">(</span>abs <span class="org-rainbow-delimiters-depth-7">(</span>- v <span class="org-rainbow-delimiters-depth-8">(</span>f v<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> tolerance<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>v<span class="org-rainbow-delimiters-depth-5">)</span>
                        <span class="org-rainbow-delimiters-depth-5">(</span>f v<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   first-guess<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id='disqus_thread'></div>
<script type='text/javascript'>
  // required: replace example with your forum shortname
  var disqus_shortname = 'kevin5396blog';
  (function() {
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] ||
       document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript><p>Please enable JavaScript to view the
  <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a></p>
</noscript><div class='footer'>
Copyright 2016 &copy; <a href='https://github.com/kevin5396'>Kangwei Ling</a><br/>
Last updated 2016-09-25 <br/>
Built with <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10) <br/>
</div>
<script type='text/javascript'>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-76818760-1', 'auto');
 ga('send', 'pageview');

</script>
</div>
</body>
</html>
